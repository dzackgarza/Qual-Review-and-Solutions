---
title: CRAG 
subtitle: The Weil Conjectures 
author: D. Zack Garza
date: April 2020
theme: Berkeley 
colortheme: default 
fontfamily: noto-sans
aspectratio: 169
header-includes:
- \usepackage{cmbright}
- \usepackage{caption}
fontsize: 9pt
---

[../Subjects/Weil Conjectures](../Subjects/Weil%20Conjectures.md)


## A Quick Note

- A big thanks to Daniel Litt for organizing this reading seminar, recommending papers, helping with questions!!

- Goals for this talk: 
  - Understand the Weil conjectures, 
  - Understand *why* the relevant objects should be interesting,
  - See elementary but concrete examples,
  - Count all of the things!

# Generating Functions


## Varieties 

Fix $q$ a prime and $\FF_q$ the (unique) finite field with $q$ elements, along with its (unique) degree $n$ extensions 
$$
\FF_{q^n} = \theset{x\in \bar \FF_q \suchthat x^{q^n} - x = 0} \quad \forall~ n\in \ZZ^{\geq 1}
$$ 

Definition (Projective Algebraic Varieties)
:  Let $J = \gens{f_1, \cdots, f_M} \normal k[x_0, \cdots, x_n]$
    be an ideal, then a *projective algebraic* variety $X\subset \PP^n_\FF$ can be described as 
    $$
    X = V(J) = \theset{\vector{x} \in \PP^n_{\FF_q} \suchthat f_1(\vector x) = \cdots = f_M(\vector x) = \vector 0}
    $$
    where $J$ is generated by *homogeneous* polynomials in $n+1$ variables, i.e. there is a fixed $d = \deg f_i \in \ZZ^{\geq 1}$ such that 

    \begin{align*}
    f(\vector x) = \sum_{\substack{\vector I = (i_1, \cdots, i_n) \\ \sum_j i_j = d}} \alpha_{\vector I} \cdot x_0^{i_1}\cdots x_n^{i_n} 
    \qtext{ and } f(\lambda \cdot \vector x) = \lambda^d f(\vector x), \lambda \in \FF\units
    .\end{align*}


## Point Counts

- For a fixed variety $X$, we can consider its $\FF_q\dash$points $X(\FF_q)$.
  - Note that $\# X(\FF_q) < \infty$ is an integer
- For any $L/\FF_q$, we can also consider $X(L)$
  - For $[L: \FF_q]$ finite, $\# X(L) < \infty$ and are integers for every such $n$.
  - In particular, we can consider the finite counts $\# X(\FF_{q^n})$ for any $n\geq 2$.
- So we can consider the sequence

\small
\begin{align*}
[N_1, N_2, \cdots , N_n, \cdots ] \definedas [\# X(\FF_q), ~ \#X (\FF_{q^2}), \cdots, ~\# X(\FF_{q^n}), \cdots]
.\end{align*}
\normalsize

- Idea: associate some generating function (a formal power series) encoding the sequence, e.g. $$F(z) = \sum_{n=1}^\infty N_n z^n = N_1z + N_2 z^2 + \cdots .$$

## Why Generating Functions?

For *ordinary* generating functions, the coefficients are related to the real-analytic properties of $F$:
\begin{align*}
[z^n] \cdot F(z) = [z^n]\cdot T_{F, z=0}(z) = \frac{1}{n!} \qty{\dd{}{z}}^{n} F(z) \Bigg\rvert_{z = 0} = N_n
\end{align*}

and also to the complex analytic properties:
\begin{align*}
[z^n] \cdot F(z) \definedas \frac{1}{2\pi i} \oint_{\SS^1} {F(z) \over z^{n+1}}~dz = \frac{1}{2\pi i} \oint_{\SS^1} \frac{N_n}{z} ~dz = N_n
.\end{align*}

> Using the Residue theorem. The latter form is very amenable to computer calculation.

## Why Generating Functions?

- An OGF is an infinite series, which we can interpret as an analytic function $\CC\to \CC$ 

- In nice situations, we can hope for a closed-form representation.

- A useful example: by integrating a geometric series we can derive

\begin{align*}
{1 \over 1-z} 
&= \sum_{n=0}^\infty z^n  
\hspace{5em} \qty{ = 1 + z + z^2 + \cdots} \\
\implies \int {1 \over 1-z} 
&= \int \sum_{n = 0}^\infty z^n \\
&= \sum_{n=0}^\infty \int z^n \quad{for } \abs{z} <  1 \qtext{by uniform convergence} \\
&= \sum_{n=0}^\infty \frac{1}{n+1}z^{n+1} 
\\
\implies -\log\qty{1-z} 
&= \sum_{n=1}^\infty {z^n \over n}  
\hspace{5em} \qty{= z + {z^2 \over 2} + {z^3 \over 3} + \cdots} 
.\end{align*}

## Exponential 

- For completeness, also recall that 
$$
\exp(z) \definedas \sum_{n=0}^\infty {z^n \over n!}
$$

- We can regard $\exp, \log$ as elements in the ring of formal power series $\QQ[[z]]$.

- In particular, for any $p(z) \in z\cdot \QQ[[z]]$ we can consider $\exp(p(z)), \log(1 + p(z))$

- Since $\QQ \injects \CC$, we can consider these as a complex-analytic functions, ask where they converge, etc.


# Zeta Functions

## Definition: Local Zeta Function

Problem: count points of a (smooth?) projective variety $X/\FF$ in all (finite) degree $n$ extensions of $\FF$.

Definition (Local Zeta Function)
:   The *local zeta function* of an algebraic variety $X$ is the following formal power series:

    \begin{align*}
    Z_X(z) &= \exp\qty{ \sum_{n=1}^\infty N_n {z^n \over n} } \in \QQ[[z]] \qtext{where} N_n \definedas \# X(\FF_n)
    .\end{align*}

Note that
\begin{align*}
z \qty{\dd{}{z}} \log Z_X(z) 
&= z \dd{}{z} \qty{N_1z + N_2 {z^2 \over 2} + N_3 {z^3 \over 3} + \cdots}  \\
&= z \qty{N_1 + N_2 z +  N_3 z^2 + \cdots } \hspace{5em} \text{(unif. conv.)}\\
&= N_1 z + N_2 z^2 + \cdots
= \sum_{n=1}^\infty N_n z^n 
,\end{align*}
which is an *ordinary* generating function for the sequence $(N_n)$.

# Examples

## Example: A Point

Take $X = \pt = V(\theset{f(x) = x-c})/\FF$ for $c$ a fixed element of $\FF$.
This yields a single point over $\FF$, then 
\begin{align*}
\#X(\FF_q) &\definedas N_1 = 1 \\
\#X(\FF_{q^2}) &\definedas N_2 = 1 \\
&\vdots \\
\#X(\FF_{q^n}) &\definedas N_n = 1
\end{align*}

and so 
\begin{align*}
Z_\pt(z) 
&= \exp\qty{ 1\cdot z + 1 \cdot {z^2 \over 2} + 1 \cdot {z^3 \over 3} + \cdots } = \exp\qty{\sum_{n=1}^\infty {{z}^n \over n} }  \\
&= \exp\qty{ -\log\qty{1-z} } \\
&= {1 \over 1 - z} 
.\end{align*}


> Notice: $Z$ admits a closed form **and** is a rational function.

## Example: The Affine Line

Take $X = \AA^1/\FF$ the affine line over $\FF$, then
We can write 
$$
\AA^1(\FF_{q^n}) = \theset{\vector x = [x_1] \suchthat x_1 \in \FF_{q^n}}
$$ 
as the set of one-component vectors with entries in $\FF_n$, so
\begin{align*}
X(\FF_q) &= q \\
X(\FF_{q^2}) &= q^2 \\
&\vdots \\
X(\FF_{q^n}) &= q^n
.\end{align*}

Then
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty q^n {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty {\qty{qz}^n \over n} }  \\
&= \exp(-\log(1 - qz)) \\
&= \frac 1 {1 - qz}
.\end{align*}



## Example: Affine m-space

Take $X = \AA^m/\FF$ the affine line over $\FF$, then
We can write 
$$
\AA^m(\FF_{q^n}) = \theset{\vector x = [x_1, \cdots, x_m] \suchthat x_i \in \FF_{q^n}}
$$ 
as the set of one-component vectors with entries in $\FF_n$, so
\noindent
\begin{minipage}{.45\textwidth}
\small
\begin{align*}
X(\FF_q) &= q^m \\
X(\FF_{q^2}) &= (q^2)^m \\
&\vdots \\
X(\FF_{q^n}) &= q^{nm}
.\end{align*}
   \normalsize
\end{minipage}
\begin{minipage}{.45\textwidth}
   \centering
    \includegraphics[width = .5\linewidth]{figures/image_2020-04-23-00-21-46.png}
\captionof{figure}{$\AA^2 / \FF_3 ~(q=3, m = 2, n = 1)$}
\end{minipage}

Then
\small
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty q^{nm} {z^n \over n} }  
= \exp\qty{\sum_{n=1}^\infty {\qty{q^m z}^n \over n} }  \\
&= \exp(-\log(1 - q^mz)) \\
&= \frac 1 {1 - q^mz}
.\end{align*}
\normalsize

## Example: Projective Line

Take $X = \PP^1/\FF$, we can still count by enumerating coordinates:
\small
\begin{align*}
\PP^1(\FF_{q^n}) 
&= \theset{[x_1: x_2] \suchthat x_1, x_2 \neq 0 \in \FF_{q^n}}/\sim  
~= \theset{[x_1: 1] \suchthat x_1 \in \FF_{q^n}} \disjoint \theset{[1: 0]}
.\end{align*}
\normalsize

Thus

\noindent
\begin{minipage}{.45\textwidth}
\small
    \begin{align*}
    X(\FF_q) &= q + 1\\
    X(\FF_{q^2}) &= q^2 + 1 \\
    &\vdots \\
    X(\FF_{q^n}) &= q^n + 1
    .\end{align*}
    \normalsize
\end{minipage}
\begin{minipage}{.45\textwidth}
   \centering
    \includegraphics[width = .5\linewidth]{figures/image_2020-04-23-00-07-42.png}
\captionof{figure}{$\PP^1 / \FF_3 ~(q=3, n = 1)$}
\end{minipage}

Thus
\small
\begin{align*}
Z_X(z) 
&= \exp\qty{\sum_{n=1}^\infty \qty{q^n + 1} {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty {q^n } {z^n \over n} + \sum_{n=1}^\infty 1 \cdot {z^n \over n}}\\
&= {1 \over (1-qz)(1-z)}
.\end{align*}
\normalsize


# The Weil Conjectures

##  Weil 1

(Weil 1949)

Let $X$ be a smooth projective variety of dimension $N$ over $\FF_{q}$ for $q$ a prime,  let $Z_X(z)$ be its zeta function, and define $\zeta_X(s) = Z_X(q^{-s})$. 


1. (Rationality) 

    $Z_X(z)$ is a rational function:

    \begin{align*}
    Z_X(z) &= 
    {p_1(z) \cdot p_3(z) \cdots p_{2N-1}(z) 
    \over 
    p_0(z) \cdot p_2(z) \cdots p_{2N}(z)} \in \QQ(z),\quad\text{i.e. }\quad p_i(z) \in \ZZ[z] \\ \\
    P_0(z) &= 1-z \\
    P_{2N}(z) &= 1 - q^N z \\
    P_j(z) &= \prod_{j=1}^{\beta_i} \qty{1 - a_{j, k} z} \qtext{for some reciprocal roots} a_{j, k} \in \CC
    \end{align*}
    where we've factored each $P_i$ using its reciprocal roots $a_{ij}$.

    \small
    In particular, this implies the existence of a meromorphic continuation of the associated function $\zeta_X(s)$, which a priori only converges for $\Re(s)\gg 0$.
    This also implies that for $n$ large enough, $N_n$ satisfies a linear recurrence relation.
    \normalsize

## Weil 2

2. (Functional Equation and Poincare Duality) 

    Let $\chi(X)$ be the Euler characteristic of $X$, i.e. the self-intersection number of the diagonal embedding $\Delta \injects X\cross X$; then $Z_X(z)$ satisfies the following *functional equation*:

    \begin{align*}
    Z_X\qty{1 \over q^N z} = \pm \qty{q^{N \over 2} z}^{\chi(X)} ~~Z_X(z)
    .\end{align*}

    Equivalently,
    \begin{align*}
    \zeta_X(N-s) = \pm \qty{q^{\frac N 2 - s}}^{\chi(X)} ~\zeta_X(s)
    .\end{align*}

    > \small Note that when $N=1$, e.g. for a curve, this relates $\zeta_X(s)$ to $\zeta_X(1-s)$.\normalsize
  
    Equivalently, there is an involutive map on the (reciprocal) roots 
    \begin{align*}
    z &\iff {q^N \over z} \\
    \alpha_{j, k} &\iff \alpha_{2N-j, k}
    \end{align*}
    which sends interchanges the coefficients in $p_j$ and $p_{2N-j}$.

## Weil 3

3. (Riemann Hypothesis)

    The reciprocal roots $\alpha_{j,k}$ are *algebraic* integers (roots of some monic $p\in \ZZ[x]$) which satisfy 
    \begin{align*}
    \abs{\alpha_{j,k}}_\CC = q^{j \over 2},  \quad\quad 1 \leq j \leq 2N-1,~ \forall k
    .\end{align*}
  


4. (Betti Numbers)
  
    If $X$ is a "good reduction mod $q$" of a nonsingular projective variety $\tilde X$ in characteristic zero, then the $\beta_i = \deg p_i(z)$ are the Betti numbers of the topological space $\tilde X(\CC)$.

Moral: 

- The Diophantine properties of a variety's zeta function are governed by its (algebraic) topology.
- Conversely, the analytic properties of encode a lot of geometric/topological/algebraic information.

## Why is (3) called the "Riemann Hypothesis"?

Recall the Riemann zeta function is given by
\begin{align*}
\zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s} = \prod_{p\text{ prime}} {1 \over 1 - p^{-s}}
.\end{align*}

After modifying $\zeta$ to make it symmetric about $\Re(s) = \frac 1 2$ and eliminate the trivial zeros to obtain $\hat \zeta(s)$, there are three relevant properties

1. "Rationality": $\hat \zeta(s)$ has a meromorphic continuation to $\CC$ with simple poles at $s=0, 1$. 
2. "Functional equation": $\hat \zeta(1-s) = \hat \zeta(s)$
3. "Riemann Hypothesis": The only zeros of $\hat \zeta$ have $\Re(s) = \frac 1 2$.


## Why is (3) called the "Riemann Hypothesis"?

Suppose it holds for some $X$. Use the facts:

a. $\abs{\exp\qty{z}} = \exp\qty{\Re(z)}$ and 
b. $a^z \definedas \exp\qty{z ~\Log(a)}$,

and to replace the polynomials $P_j$ with 
\begin{align*}
L_j(s) \definedas P_j(q^{-s}) = \prod_{k=1}^{\beta_j} \qty{1 - \alpha_{j, k} q^{-s}}
.\end{align*}


## Analogy to Riemann Hypothesis

Now consider the roots of $L_j(s)$: we have
\small
\begin{align*}
L_j(s_0) = 0 
\iff (1 - \alpha_{j, k} q^{-s}) &= 0 \qtext{for some} k\\
\iff q^{-s_0} &= {1 \over \alpha_{j, k}} \\
\iff \abs{q^{-s_0}} &= \abs{1 \over \alpha_{j, k}} \quad\quad \stackrel{\text{\tiny by assumption}}{=} q^{ -{j \over 2}} \\ \\
\iff q^{-\frac j 2} \stackrel{(a)}= \exp\qty{- \frac j 2  \cdot \Log(q)} &= \abs{ \exp\qty{-s_0 \cdot \Log(q)} } \\
&\stackrel{(b)}= \abs{ \exp\qty{-\qty{\Re(s_0) + i\cdot \Im(s_0)} \cdot \Log(q)} }  \\
&\stackrel{(a)}= \exp\qty{-\qty{\Re(s_0)} \cdot \Log(q)}  \\ \\
\iff - \frac j 2 \cdot \Log(q) &= -\Re(s_0) \cdot \Log(q) \qtext{by injectivity} \\
\iff \Re(s_0) = \frac j 2
.\end{align*}
\normalsize

## Analogy with Riemann Hypothesis

Roughly speaking, we can apply $\Log$ (a conformal map) to send the $\alpha_{j, k}$ to zeros of the $L_j$, this says that the zeros all must lie on the "critical lines" $\frac{j}{2}$.

\begin{figure}[h]
\centering
\includegraphics[width = 1.0\textwidth]{figures/image_2020-04-23-02-26-27.png} 
\end{figure}

In particular, the zeros of $L_1$ have real part $\frac 1 2$ (analogy: classical Riemann hypothesis).

## Precise Relation

- Difficult to find in the literature! 
- Idea: make a similar definition for schemes, then take $X = \spec \ZZ$.
- Define the "reductions mod $p$" $X_p$ for closed points $p$.
- Define the *local* zeta functions $\zeta_{X_p}(s) = Z_{X_p}(p^{-s})$.
- (Potentially incorrect) Evaluate to find $Z_{X_p}(z) = {1 \over 1 - z}$.
- Take a product over all closed points to define

\begin{align*}
L_X(s) 
&= \prod_{p\text{ prime}} \zeta_{X_p}(p^{-s}) \\
&= \prod_{p\text{ prime}} \qty{ 1 \over 1 - p^{-s}} \\
&= \zeta(s)
,\end{align*}

which is the Euler product expansion of the classical Riemann Zeta function.

> If anyone knows a reference for this, let me know!

# Weil for Curves

## Weil for Curves 

The Weil conjectures take on a particularly nice form for curves.
Let $X/\FF_q$ be a smooth projective curve of genus $g$, then

1. (Rationality) $$Z_X(z) = {p_1(z) \over p_0(z) p_2(z)} = {p_1(z) \over (1-z)(1-qz)}$$
2. (Functional Equation) $$Z_X\qty{1 \over qz} = \qty{z\sqrt q}^{2-2g} Z_X(z)$$
3. (Riemann Hypothesis) $$p_1(z) = \prod_{i=1}^{\beta_1} (1 - a_iz ) \qtext{where} \abs{a_i} = \sqrt{q}$$
4. (Betti Numbers) $\mcp_{\Sigma_g}(x) = 1 + 2g\cdot x + x^2 \implies \deg p_1 = \beta_1 = 2g$.


\tiny
> $\mcp$ here is the Poincaré polynomial, the generating function for the Betti numbers.
> $\Sigma_g$ is the surface (real 2-dimensional smooth manifold) of genus $g$.
\normalsize

## The Projective Line

Recall $Z_{\PP^1/\FF_q}(z) = {1 \over (1-z)(1-qz)}$.

1. Rationality: Clear!
2. Functional Equation: $g=0 \implies 2g-2 = 2$
\begin{align*}
Z_{\PP^1}\qty{{1 \over qz}}
= {1 \over (1-{1 \over qz})(1 - {q \over qz}) }  
= {qz^2 \over (1-z)(1-qz)} 
= {\qty{\sqrt q z}^2 \over (1-z)(1-qz) }
.\end{align*}

3. Riemann Hypothesis: Nothing to check (no $p_1(z)$)
4. Betti numbers: Use the fact that $\mcp_{\CP^1} = 1 + 0\cdot x + x^2$, and indeed $\deg p_0 = \deg p_2 = 1,~ \deg p_1 = 0$.

> Note that even Betti numbers show up as degrees in the denominator, odd in the numerator.
> Allows us to immediately guess the zeta function for $\PP^n/\FF_q$ by knowing $H^* \CP^\infty$!


## Elliptic Curves 

\begin{figure}[h]
\caption{Some Elliptic Curves}
\centering
\includegraphics[width = 0.9\textwidth]{figures/image_2020-04-23-02-40-31.png} 
\end{figure}

Consider $E/\FF_q$. 

- (Nontrivial!) The number of points is given by
$$
N_n \definedas E(\FF_{q^n}) = (q^n + 1) - ( \alpha^n + {\bar \alpha}^n ) \qtext{where} \abs{\alpha} = \abs{\bar \alpha} = \sqrt{q}
$$
  - **Proof**: Involves trace (or eigenvalues?) of Frobenius, (could use references)

- $\dim_\CC E/\CC = N = 1$ and $g=1$.



The Weil Conjectures say we should be able to write 
\begin{align*}
Z_E(z) = {p_1(z)  \over p_0(z) p_2(z)} = 
{p_1(z) \over (1-z) (1 - qz)} =
{ (1 - a_{1}z)(1 - a_{2}z)  \over (1-z)(1- qz)}
.\end{align*}

## Elliptic Curves: Weil 1

1. Rationality: using the point count, we can compute 
\small
\begin{align*}
Z_E(z) 
&= \exp \sum_{n=1}^\infty \# E(\FF_{q^n}) {z^n \over n} \\
&= \exp \sum_{n=1}^\infty \qty{q^n + 1 - \qty{\alpha^n + \bar\alpha^n}} {z^n \over n} \\
&=
\exp \qty{ \sum_{n=1}^\infty q^n\cdot {z^n \over n} }
\exp \qty{ \sum_{n=1}^\infty 1\cdot {z^n \over n} } \\
& \hspace{5em} \exp \qty{ \sum_{n=1}^\infty -\alpha^n \cdot {z^n \over n} }
\exp \qty{ \sum_{n=1}^\infty -\bar\alpha^n\cdot{z^n \over n} } \\ \\
&=
\exp\qty{-\log\qty{1-qz} }
\cdot \exp\qty{-\log\qty{1-z} } \\
&\hspace{5em} \exp\qty{\log\qty{1- \alpha z} }
\cdot \exp\qty{\log\qty{1 - \bar \alpha z} } \\ \\ 
&= {(1-\alpha z)(1-\bar \alpha z) \over (1-z)(1-qz)} \in \QQ(z)
,\end{align*}
\normalsize
which is a rational function of the expected form (Weil 1).

\tiny
> Note that the "expected" point counts show up in the denominator, along with the even Betti numbers, while the "correction" factor appears in the denominator and odd Betti numbers.
\normalsize


## Elliptic Curves: Weil 2 and 3

2. Functional Equation: we use the equivalent formulation of "Poincaré duality": 
\begin{align*}
{(1-\alpha z)(1-\bar \alpha z) \over (1-z)(1-qz)} =  
{p_1(z) \over p_0(z) p_2(z)}  \implies 
\begin{cases}
z &\iff {q \over z} \\
\alpha_{j, k} &\iff \alpha_{2-j, k}
\end{cases}
\end{align*}

This amounts to checking that the coefficients of $p_0, p_2$ are interchanged, and that the two coefficients of $p_1$ are interchanged:

\begin{align*}
\mathrm{Coefs}(p_0) = \theset{1} &\mapsvia{z\to {q\over z}} \theset{1 \over q} = \mathrm{Coefs}(p_2)  \\
\mathrm{Coefs}(p_1) = \theset{\alpha, \bar \alpha} &\mapsvia{z\to {q\over z}}  \theset{{q \over \alpha}, {q \over \bar\alpha} } = \theset{\bar \alpha, \alpha} \qtext{using} \alpha\bar\alpha = q
.\end{align*}

3. RH: Assumed as part of the point count ($\abs \alpha = q^{1\over 2}$)

4. Betti Numbers: $\mcp_{\Sigma_1}(x) = 1 + 2x + x^2$, and indeed $\deg p_0 = \deg p_2 = 1,~ \deg p_1 = 2$.

## History

- 1801, Gauss: Point count and RH showed for specific elliptic curves

- 1924, Artin: Conjectured for algebraic curves , 

- 1934, Hasse:  proved for elliptic curves.

- 1949, Weil: Proved for smooth projective curves over finite fields, proposed generalization to projective varieties

- 1960, Dwork: Rationality via $p\dash$adic analysis

- 1965, Grothendieck et al.: Rationality, functional equation, Betti numbers using  étale cohomology 
  - Trace of Frobenius on $\ell\dash$adic cohomology
  - Expected proof via *the standard conjectures*. Wide open!

- 1974, Deligne: Riemann Hypothesis using étale  cohomology, circumvented the standard conjectures

- Recent: Hasse-Weil conjecture for arbitrary algebraic varieties over number fields
  - Similar requirements on $L\dash$functions: functional equation, meromorphic continuation
  - 2001: Full modularity theorem proved, extending Wiles, implies Hasse-Weil for elliptic curves
  - Inroad to Langlands: show every $L$ function coming from an algebraic variety also comes from an automorphic representation.


# Weil for Projective m-space

## Setup 

Take $X = \PP^m/\FF$ 
We can write 
$$
\PP^m(\FF_{q^n}) = \AA^{m+1}(\FF_{q^n}) \setminus \theset{\vector 0}/\sim ~= \theset{\vector x = [x_0, \cdots, x_m] \suchthat x_i \in \FF_{q^n}}/\sim
$$

But how many points are actually in this space?

\begin{figure}[h]
\caption{Points and Lines in $\PP^2/{\FF_3}$}
\centering
\includegraphics[width = 0.4\textwidth]{figures/image_2020-04-19-22-32-07.png} 
\end{figure}

> A nontrivial combinatorial problem!


## q-Analogs and Grassmannians 

To illustrate, this can be done combinatorially:
identify $\PP^m_\FF = \Gr_{\FF}(1, m+1)$ as the space of lines in $\AA^{m+1}_\FF$.

Theorem
:   The number of $k\dash$dimensional subspaces of $\AA^N_{\FF_q}$ is the $q\dash$analog of the binomial coefficient:
    \begin{align*}
    \genfrac{[}{]}{0pt}{}{N}{k}_q \definedas \frac{(q^N - 1)(q^{N-1}-1) \cdots (q^{N - (k-1)} -  1)}{(q^k-1)(q^{k-1} - 1) \cdots (q-1)}
    .\end{align*}

> Remark: Note $\lim_{q\to 1} \genfrac{[}{]}{0pt}{}{N}{k}_q = {N \choose k}$, the usual binomial coefficient.

**Proof:**  To choose a $k\dash$dimensional subspace, 
  
- Choose a nonzero vector $\vector v_1 \in \AA^n_\FF$ in $q^N - 1$ ways.
  - For next step, note that $\#\spanof\theset{\vector v_1} = \#\theset{\lambda \vector v_1 \suchthat \lambda \in \FF_q} = \# \FF_q = q$.
  
- Choose a nonzero vector $\vector v_2$ *not* in the span of $\vector v_1$ in $q^N - q$ ways.
  - Now note $\# \spanof\theset{\vector v_1, \vector v_2} = \# \theset{\lambda_1 \vector v_1 + \lambda_2 \vector v_2 \suchthat \lambda_i \in \FF} = q\cdot q = q^2$.

## Proof continued

- Choose a nonzero vector $\vector v_3$ *not* in the span of $\vector v_1, \vector v_2$ in $q^N -q^2$ ways.

- $\cdots$ until $\vector v_k$ is chosen in $$(q^N-1)(q^N-q) \cdots (q^N - q^{k-1}) \qtext{ways}.$$ 
  - This yields a $k\dash$tuple of linearly independent vectors spanning a $k\dash$dimensional subspace $V_k$

- This overcounts because many linearly independent sets span $V_k$,  we need to divide out by the number of ways to choose a basis inside of $V_k$.

- By the same argument, this is given by $$(q^k-1)(q^k-q) \cdots (q^k - q^{k-1})$$ 


Thus
\small
\begin{align*}
\# \text{subspaces} 
&= \frac{ (q^N-1)(q^N-q)(q^N - q^2) \cdots (q^N - q^{k-1}) }{ (q^k-1)(q^k-q)(q^k-q^2) \cdots (q^k - q^{k-1})}\\ \\
&= {q^N - 1 \over q^k - 1} \cdot \qty{q \over q} {q^{N-1} - 1 \over q^{k-1} - 1} \cdot \qty{q^2 \over q^2}{q^{N-2} - 1 \over q^{k-2} - 1} \cdots \qty{q^{k-1} \over q^{k-1}}{q^{N - (k-1)} - 1 \over q^{k - (k-1) - 1}} \\ 
&= \frac{(q^N - 1)(q^{N-1}-1) \cdots (q^{N - (k-1)} -  1)}{(q^k-1)(q^{k-1} - 1) \cdots (q-1)}
.\end{align*}
\normalsize

$\qed$

## Counting Points 

> Note that we've actually computed the number of points in any Grassmannian.

Identify $\PP^m_\FF = \Gr_{\FF}(1, m+1)$ as the space of lines in $\AA^{m+1}_\FF$.

We obtain a simplification (importantly, a *sum formula*) when setting $k=1$:
\begin{align*}
\genfrac{[}{]}{0pt}{}{m+1 }{1}_q = {q^{m+1}-1 \over q - 1} = q^{m} + q^{m-1} + \cdots + q + 1 = \sum_{j=0}^{m} q^j
.\end{align*}

Thus
\begin{align*}
X(\FF_q) &= \sum_{j=0}^{m} q^j  \\
X(\FF_{q^2}) &= \sum_{j=0}^{m} \qty{q^2}^j  \\
&\vdots \\
X(\FF_{q^n}) &= \sum_{j=0}^{m} \qty{q^n}^j
.\end{align*}

## Computing the Zeta Function 

So
\begin{align*}
Z_X(z) 
&= \exp\qty{ \sum_{n=1}^\infty \sum_{j=0}^{m} \qty{q^n}^j {z^n \over n} } \\
&= \exp\qty{ \sum_{n=1}^\infty \sum_{j=0}^{m} {\qty{q^jz}^n \over n} } \\
&= \exp\qty{ \sum_{j=0}^{m} \sum_{n=1}^\infty {\qty{q^jz}^n \over n} } \\
&= \exp\qty{ \sum_{j=0}^{m-1} -\log(1 - q^j z) } \\
&= \prod_{j=0}^{m} \qty{1-q^jz}\inv \\
&=
\qty{1 \over 1 - z} \qty{1 \over 1 - qz} \qty{1 \over 1 - q^2 z} \cdots \qty{1 \over 1- q^m z}
,\end{align*}

> Miraculously, still a rational function! Consequence of sum formula, works in general. 

## Checking the Weil Conjectures

\begin{align*}
Z_X(z) = \prod_{j=0}^m \qty{1 \over 1 - q^j z} 
.\end{align*}

1. Rationality: Clear!

2. Functional Equation: Less clear, but true:

\begin{align*}
Z_X\left(\frac{1}{q^{m} z}\right) 
&=\frac{1}{\left(1-1 / q^{m} t\right)\left(1-q / q^{m} t\right) \cdots\left(1-q^{m} / q^{m} z\right)} \\
&=\frac{q^{m} z \cdot q^{m-1} z \ldots q z \cdot z}{(1-z)(1-q z) \ldots\left(1-q^{m} z\right)} \\
&=q^{m(m+1) \over 2} z^{m+1} \cdot Z_X(z)\\
&= \qty{q^{m\over 2}z}^{\chi(X)} \cdot Z_X(z) \\
.\end{align*}

## Checking

\begin{align*}
Z_X(z) = \prod_{j=0}^m \qty{1 \over 1 - q^j z} 
.\end{align*}

3. Riemann Hypothesis: Reduces to the statement $\theset{ \alpha_i } = \theset{{q^m \over \alpha_j }}$.
  - Clear since $\alpha_j = q^j$ and every $\alpha_i$ is a lower power of $q$.

4. Betti Numbers: Use the fact that $\mcp_{\CP^m}(x) = 1 + x^2 + x^4 + \cdots + x^{2m}$
  - Only even dimensions, and correspondingly no numerator.

## An Easier Proof: "Paving by Affines"

Quick recap:
\begin{align*}
Z_{\pt} = {1 \over 1 - z} && Z_{\PP^1}(z) = {1 \over 1 - qz} && Z_{\AA^1}(z) = {1\over (1-z)(1-qz)}
.\end{align*}

Note that $\PP^1 = \AA^1 \disjoint \theset{\infty}$ and correspondingly $Z_{\PP^1}(z) = Z_{\AA^1}(z) \cdot Z_{\pt}(z)$.
This works in general:

Lemma (Excision)
: If $Y/\FF_q \subset X/\FF_q$ is a closed subvariety, for $U = X\setminus Y$, $Z_X(z) = Z_Y(z) \cdot Z_{U}(z)$.

**Proof**:
Let $N_n = \# Y(\FF_{q^n})$ and $M_n = \# U(\FF_{q^n})$, then
\begin{align*}
\zeta_X(z) 
&= \exp\qty{\sum_{n=1}^\infty \qty{N_n + M_n} {z^n \over n} }  \\
&= \exp\qty{\sum_{n=1}^\infty N_n \cdot {z^n \over n} + \sum_{n=1}^\infty M_n \cdot {z^n \over n}}\\
&= \exp\qty{\sum_{n=1}^\infty N_n \cdot {z^n \over n}} \cdot \exp\qty{\sum_{n=1}^\infty M_n \cdot {z^n \over n}}
= \zeta_Y(z) \cdot \zeta_U(z)
.\end{align*}


## An Easier Proof: "Paving"

Note that geometry can help us here: we have a decomposition $\PP^n = \PP^{n-1} \disjoint \AA^n$, and thus inductively a stratification 
\begin{align*}
\PP^m = \disjoint_{j=0}^m \AA^j = \AA^0 \disjoint \AA^1 \disjoint \cdots \disjoint \AA^m
.\end{align*}

Recalling that 
$$
Z_{X\disjoint Y}(z) = Z_X(z) \cdot Z_Y(z)
$$

and $Z_{\AA^j}(z) = {1 \over 1 - q^j z}$, we have
\begin{align*}
Z_{\PP^m}(z) = \prod_{j=0}^m Z_{\AA^j}(z) = \prod_{j=0}^m {1 \over 1 - q^j z}
.\end{align*}


# Grassmannians 

## Motivation

Consider now $X = \Gr(k, m) / \FF$ -- by the previous computation, we know
\begin{align*}
X(\FF_{q^n}) = 
\genfrac{[}{]}{0pt}{}{m}{k}_{q^n} \definedas \frac{(q^{nm} - 1)(q^{{nm}-1}-1) \cdots (q^{{nm} - n(k-1)} -  1)}{(q^{nk}-1)(q^{n(k-1)} - 1) \cdots (q^n-1)}
\end{align*}

but the corresponding Zeta function is much more complicated than the previous examples:
\begin{align*}
Z_X(z) &= \exp\qty{ \sum_{n=1}^\infty \genfrac{[}{]}{0pt}{}{m}{k}_{q^n}   {z^n \over n} } = \cdots ?
.\end{align*}

Since $\dim_\CC \Gr_\CC (k, m) = 2k(m-k)$, by Weil we should expect 
$$
Z_X(z) = \prod_{j=0}^{2k(m-k)} \frac{p_{2(j+1)}(z)}{p_{2j}(z)}
$$ 
with $\deg p_j = \beta_j$.

## Grassmannian
It turns out that (proof omitted) one can show
\begin{align*}
\genfrac{[}{]}{0pt}{}{m}{k}_{q} = \sum_{j=0}^{k(m-k)} \lambda_{m, k}(j) q^j \implies Z_X(z) = \prod_{j=0}^{k(m-k)} \qty{ \frac{1}{ 1 - q^j x} }^{\lambda_{m, k}(j)}
\end{align*}

where $\lambda_{m, k}$ is the number of integer partitions of of $[i]$ into at most $m-k$ parts, each of size at most $k$.

- One proof idea: use combinatorial identities to write $q\dash$analog $\genfrac{[}{]}{0pt}{}{m}{k}_{q}$ as a *sum*
- Second proof idea: "pave by affines" (need a reference!)

This lets us conclude that the Poincare polynomial of the complex Grassmannian is given by 
$$
\mcp_{\Gr_\CC(m, k)}(x) = \sum_{n=1}^{k(m-k)} \lambda_{m, k}(n) x^{2n},
$$

> In particular, the $H^* \Gr_\CC(m, k)$ vanishes in odd degree.


# Weil's Proof


## Diagonal Hypersurfaces

Proof of rationality of $Z_X(T)$ for $X$ a diagonal hypersurface.

- Set $q$ to be a prime power and consider $X/\FF_q$ defined by $$X = V(a_0x_0^{n} + \cdots + a_r x_r^{n}) \subset \FF_q^{r+1}.$$
- We want to compute $N = \# X$.
- Set $d_i = \gcd(n_i, q-1)$. 
- Define the character
  \begin{align*}
  \psi_q: \FF_q & \to \CC\units \\
  a &\mapsto \exp\qty{2\pi i ~\Tr_{\FF_q/\FF_p}(a) \over p} 
  .\end{align*}
  - By Artin's theorem for linear independence of characters, $\psi_q \not \equiv 1$ and every additive character of $\FF_q$ is of the form $a \mapsto \psi_q(ca)$ for some $c\in \FF_q$.


- Shorthand notation: say $a\sim 0 \iff a \equiv 0 \mod 1$.



## A Diagonal Hypersurface

- Fix an injective multiplicative map
\begin{align*}
\phi: \bar{\FF}_q\units \to \CC\units
.\end{align*}

- Define
\begin{align*}
\chi_{\alpha, n}: \FF_{q^n}\units &\to \CC\units \\
x & \mapsto \phi(x)^{\alpha\qty{q^n-1}} \\ \\
\quad \qtext{for} \alpha \in \QQ/\ZZ, n\in \ZZ, & \quad \alpha\qty{q^n-1} \equiv 0 \mod 1 
.\end{align*}

  - Extend this to $\FF_{q^n}$ by 
  \begin{align*}
  \begin{cases}
  1 & \alpha \equiv0 \mod 1 \\
  0 & \text{else} 
  \end{cases}
  .\end{align*}
  - Set $\chi_\alpha = \chi_{\alpha, 1}$.
- Proposition: $$\alpha(q-1) \equiv 0 \mod 1 \implies \chi_{\alpha, n}(x) = \chi_\alpha(\mathrm{Nm}_{\FF_{q^n} / \FF_q }(x) )$$
- Proposition: $$d \definedas \gcd(n, q-1), u \in \FF_q \implies \#\theset {x\in \FF_q \suchthat x^n = u} = \sum_{d\alpha \sim 0} \chi_\alpha(u)$$


## A Diagonal Hypersurface

- This implies
\begin{align*}
N &= \sum_{\substack{\alpha = [\alpha_0, \cdots, \alpha_r] \\ d_i \alpha_i \sim 0}} \quad \sum_{\substack{\vector u = [u_0, \cdots ,u_r] \\ \Sigma~ a_i u_i = 0}}
\quad \prod_{j=0}^r \chi_{\alpha_j}(u_j) \\ \\ 
&= q^r + \sum_{\substack{\alpha,~ \alpha_i \in (0, 1) \\ d_i \alpha_i \sim 0}} 
\qty{ \prod_{j=0}^r \chi_{\alpha_j}(a_j \inv ) \sum_{\Sigma~ u_i=0}  \quad \prod_{j=0}^r \chi_{\alpha_j}(u_j) }
.\end{align*}
  since the inner sum is zero if some *but not all* of the $\alpha_i \sim 0$.

- Evaluate the innermost sum by restricting to $u_0 \neq 0$ and setting $u_i = u_0 v_i$ and $v_0 \definedas 1$:
\begin{align*}
\sum_{\Sigma~ u_i=0}  \quad \prod_{j=0}^r \chi_{\alpha_j}(u_j)
&=
\sum_{u_0 \neq 0} \chi_{_{\Sigma ~ \alpha_i}}(u_0) 
\sum_{\Sigma ~v_i = 0} ~\prod_{j=0}^r \chi_{\alpha_j} (v_j)  \\
&=
\begin{cases}
\qty{q-1} \sum_{\Sigma~ v_i = 0} ~\prod_{j=0}^r \chi_{\alpha_j}(v_j)  & \qtext{if} \sum \alpha_i \sim 0 \\
0 & \qtext{else}
\end{cases}
.\end{align*}


## A Diagonal Hypersurface

- Define the *Jacobi sum* for $\alpha$ where $\sum \alpha_i \sim 0$:
\begin{align*}
J(\alpha) \definedas  \qty {1 \over q-1} \sum_{\Sigma~ u_i = 0} ~\prod_{j=0}^r \chi_{\alpha_j}(u_j) = \sum_{\Sigma~ v_i = 0} ~\prod_{j=1}^r \chi_{\alpha_j}(v_j) 
\end{align*}

- Express $N$ in terms of Jacobi sums as 
\begin{align*}
N = q^r + \qty{q-1} \sum_{\substack{\Sigma \alpha_i \sim 0 \\ d_i \alpha_i \sim 0 \\ \alpha\in (0, 1)}} \prod_{j=0}^r \chi_{\alpha_j}(a_j\inv ) J(\alpha)
.\end{align*}

- Evaluate $J(\alpha)$ using Gauss sums: for $\chi: \FF_q \to \CC$ a multiplicative character, define
\begin{align*}
G(\chi) &\definedas  \sum_{x\in \FF_q} \chi(x) \psi_q(x)
.\end{align*}

- Proposition: for any $\chi \neq \chi_0$, 
  - $\abs{G(\chi)} = q^{1 \over 2}$
  - $G(\chi) G(\bar \chi) = q \chi(-1)$
  - $G(\chi_0) = 0$
  \begin{align*}
  \chi(t) = {G(\chi) \over q} \sum_{x\in \FF_q} \bar \chi(x) \psi_q(tx) 
  .\end{align*}

## A Diagonal Hypersurface

- Proposition: if 
\begin{align*}
\sum \alpha_i \sim 0 \implies J(\alpha) = {1 \over q} \prod_{k=1}^r G(\chi_{\alpha_k}) \qtext{and} \abs{J(\alpha)} = q^{r - 1\over 2}
.\end{align*}
- We thus obtain
\begin{align*}
N = q^r + \qty{q-1 \over q} \sum_{\substack{\Sigma \alpha_i \sim 0 \\ d_i \alpha_i \sim 0 \\ \alpha\in (0, 1)}} ~\prod_{j=0}^r \chi_{\alpha_j}(a_j\inv ) G(\chi_{\alpha_j})
.\end{align*}
- We now ask for number of points in $\FF_{q^\nu}$ and consider a point count 
\begin{align*}
\bar{N}_\nu = \# \theset{[x_0: \cdots : x_r] \in \PP^r_{\FF_q^\nu} \suchthat \sum_{i=0}^r a_i x_i^n = 0}
.\end{align*}

- Theorem (Davenport, Hasse) $$\qty{q-1}\alpha \sim 0 \implies -G(\chi_{\alpha, \nu}) = \qty{-G(\chi_\alpha)}^\nu.$$

## A Diagonal Hypersurface

- We have a relation $\qty{q^\nu - 1} \bar N_\nu = N_\nu$.
- This lets us write
\begin{align*}
\bar N_\nu = \sum_{j=0}^{r-1} q^{j\nu} + \sum_{\substack{\sum \alpha_i ~\sim 0 \\ \gcd(n, q^\nu - 1)\alpha_i \sim 0 \\ \alpha_i \in (0, 1) }} 
 \prod_{j=0}^r \bar \chi_{\alpha_{j, \nu}}(a_i) J_\nu(\alpha)
.\end{align*}
- Set
\begin{align*}
\mu(\alpha) &= \min\theset{\mu \suchthat \qty{q^\mu - 1} \alpha \sim 0} \\
C(\alpha) &= (-1)^{r+1} \prod_{j=1}^r \bar \chi_{\alpha_0, \mu(\alpha)}(a_j) \cdot J_{\mu(\alpha)}(\alpha)
.\end{align*}
- Plugging into the zeta function $Z$ yields
\begin{align*}
\exp\qty{\sum_{\nu = 1}^\infty \bar N_\nu {T^\nu \over \nu} }
= \prod_{j=0}^{r-1} \qty{1 \over 1 - q^j T}
\prod_{\substack{\sum \alpha_i \sim 0 \\ \gcd(n, q^\nu - 1)\alpha_i \sim 0 \\ \alpha_i \in (0, 1) }}
\qty{1 - C(\alpha) T^{\mu(\alpha)}}^{(-1)^r \over \mu(\alpha)}
,\end{align*}
which is evidently a rational function!
$\qed$
